{
  "project": "Enterprise Task Redesign — Remove Over-Hinting",
  "branchName": "ralph/enterprise-task-redesign",
  "description": "Redesign 9 over-hinted enterprise/governance tasks to remove exact file paths, line numbers, struct names, and implementation roadmaps. Tasks should describe the problem by behavior only, forcing MCP discovery. Replace in-place, annotate old runs.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Redesign Flipt enterprise tasks batch 1",
      "description": "As a benchmark designer, I want dep-discovery-001, dep-refactor-001, and dep-refactor-002 to describe problems without revealing file locations.",
      "acceptanceCriteria": [
        "benchmarks/ccb_enterprise/dep-discovery-001/instruction.md does NOT contain 'evaluation.go', 'approximately 9 packages', or any specific package count",
        "benchmarks/ccb_enterprise/dep-refactor-001/instruction.md does NOT contain 'resource.go', 'approximately 10 call sites', or '8 files'",
        "benchmarks/ccb_enterprise/dep-refactor-002/instruction.md does NOT contain 'fs/store.go', 'fs/snapshot.go', 'sql/common/flag.go', or any implementation file paths",
        "All three instructions still describe the expected behavior and acceptance criteria clearly",
        "grep -ri 'storage.go\\|resource.go\\|store.go\\|snapshot.go\\|flag.go\\|approximately' benchmarks/ccb_enterprise/dep-discovery-001/instruction.md benchmarks/ccb_enterprise/dep-refactor-001/instruction.md benchmarks/ccb_enterprise/dep-refactor-002/instruction.md returns zero matches for file paths and approximate counts",
        "Each tests/test.sh file is unchanged"
      ],
      "priority": 1,
      "passes": true,
      "notes": "These are Flipt (Go) tasks. dep-discovery-001: remove starting file and package count hints. dep-refactor-001: remove resource.go path, call site count. dep-refactor-002: worst offender — all 3 implementation files listed by name. Keep the interface name (ReadOnlyFlagStore) but remove WHERE it's defined and WHERE the implementations are."
    },
    {
      "id": "US-002",
      "title": "Redesign Flipt enterprise+governance tasks batch 2",
      "description": "As a benchmark designer, I want polyglot-ecosystem-001, multi-team-ownership-002, and degraded-context-001 to describe problems without revealing implementation details.",
      "acceptanceCriteria": [
        "benchmarks/ccb_enterprise/polyglot-ecosystem-001/instruction.md does NOT contain 'line 25-92', 'field number 10', 'GetSegmentKeys', or any line number references",
        "benchmarks/ccb_enterprise/multi-team-ownership-002/instruction.md does NOT contain 'duration.go' or 'DurationTracker'",
        "benchmarks/ccb_governance/degraded-context-001/instruction.md does NOT contain 'errors.go', 'EvalError', specific struct field names, or phase-specific wrapping targets like 'GetEvaluationRules'",
        "All three instructions still describe the expected behavior clearly",
        "grep -rni 'line 25\\|field.number\\|GetSegmentKeys\\|duration\\.go\\|DurationTracker\\|errors\\.go\\|EvalError\\|GetEvaluationRules\\|GetEvaluationDistributions\\|GetEvaluationRollouts' benchmarks/ccb_enterprise/polyglot-ecosystem-001/instruction.md benchmarks/ccb_enterprise/multi-team-ownership-002/instruction.md benchmarks/ccb_governance/degraded-context-001/instruction.md returns zero matches",
        "Each tests/test.sh file is unchanged"
      ],
      "priority": 2,
      "passes": true,
      "notes": "polyglot-ecosystem-001: removed line numbers, field number hint (10), GetSegmentKeys, Hints section, file path navigation instructions. multi-team-ownership-002: removed duration.go filename and DurationTracker struct name — verifier checks for these but agent must discover appropriate naming. degraded-context-001: removed errors.go, EvalError, struct field names, storage method names (GetEvaluationRules etc.), error format string, Hints section. Phase names (rules/distributions/rollouts) kept as behavioral requirements. NOTE: multi-team-ownership-002 and degraded-context-001 verifiers are flexible on naming (EvalError|evalError|eval_error|EvaluationError accepted)."
    },
    {
      "id": "US-003",
      "title": "Redesign remaining governance+enterprise tasks batch 3",
      "description": "As a benchmark designer, I want repo-scoped-access-002, policy-enforcement-001, and dep-impact-001 to describe problems without revealing implementation details.",
      "acceptanceCriteria": [
        "benchmarks/ccb_governance/repo-scoped-access-002/instruction.md does NOT contain 'metrics.go' or 'EvaluationMetrics'",
        "benchmarks/ccb_governance/policy-enforcement-001/instruction.md does NOT contain 'SoftDeleteManager', specific method signatures, or specific field names like 'is_deleted', 'deleted_at', 'deleted_by'",
        "benchmarks/ccb_enterprise/dep-impact-001/instruction.md does NOT contain 'options.py', 'admin_changelist/', or 'approximately 5 files'",
        "All three instructions still describe the expected behavior clearly",
        "grep -rni 'metrics\\.go\\|EvaluationMetrics\\|SoftDeleteManager\\|is_deleted\\|deleted_at\\|options\\.py\\|admin_changelist\\|approximately.5' benchmarks/ccb_governance/repo-scoped-access-002/instruction.md benchmarks/ccb_governance/policy-enforcement-001/instruction.md benchmarks/ccb_enterprise/dep-impact-001/instruction.md returns zero matches",
        "Each tests/test.sh file is unchanged"
      ],
      "priority": 3,
      "passes": false,
      "notes": "repo-scoped-access-002: describe need for metrics tracking without naming file or struct. policy-enforcement-001: describe soft-delete behavior requirement without naming the class, method signatures, or fields. dep-impact-001: describe get_list_filter impact analysis without naming the source file or test directory."
    },
    {
      "id": "US-004",
      "title": "Update ground truth and annotate old runs",
      "description": "As an analyst, I want ground truth updated for redesigned tasks and old runs annotated so pre-redesign data can be filtered from analysis.",
      "acceptanceCriteria": [
        "scripts/ccb_metrics/ground_truth.py ground truth entries for redesigned tasks are reviewed and updated if the expected file access pattern changed",
        "configs/ground_truth_files.json is rebuilt (python3 scripts/ir_analysis.py --build-ground-truth)",
        "SKIP_PATTERNS in scripts/ir_analysis.py includes '__v1_hinted'",
        "SKIP_PATTERNS in scripts/aggregate_status.py includes '__v1_hinted'",
        "SKIP_PATTERNS in scripts/generate_manifest.py includes '__v1_hinted'",
        "Documentation added as a comment near SKIP_PATTERNS explaining __v1_hinted annotation purpose"
      ],
      "priority": 4,
      "passes": false,
      "notes": "Old run directories will be renamed manually (appending __v1_hinted) after reruns complete — that's a manual step outside Ralph. This story just ensures the analysis pipeline will correctly skip them when encountered. Ground truth for these tasks is in _ENTERPRISE_GROUND_TRUTH and _GOVERNANCE_GROUND_TRUTH dicts in ground_truth.py — verify the file lists still make sense after instruction changes."
    }
  ]
}
