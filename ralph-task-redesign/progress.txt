## Codebase Patterns

### Enterprise Task Structure
- Tasks in benchmarks/ccb_enterprise/{task_name}/ with instruction.md, task.toml, tests/test.sh, environment/Dockerfile
- Governance tasks in benchmarks/ccb_governance/{task_name}/ with same structure
- instruction.md is the agent prompt — this is what we're editing to remove hints
- tests/test.sh is the verifier — do NOT modify, it tests the same expected behavior
- task.toml has metadata (difficulty, language, time_limit_sec) — no changes needed

### Over-Hinting Patterns to Remove
- Exact file paths: "in `internal/storage/resource.go`" → describe the function/behavior instead
- Line numbers: "around line 25-92" → remove entirely
- Implementation file lists: listing all 3 implementation files by name → "implement in all types satisfying the interface"
- Approximate counts: "approximately 10 call sites across 8 files" → "update all call sites"
- Struct/class names for NEW code: "Create `DurationTracker` struct" → describe the behavior requirement
- Field numbers: "Use field number 10" → remove entirely
- Pseudocode: struct field lists → describe what information the struct should carry

### What to KEEP in Instructions
- The problem statement and expected behavior
- Interface/function names that already exist in the codebase (agent needs to know WHAT to find, not WHERE)
- Language and framework context (Go, Python, Django, Flipt)
- Behavioral acceptance criteria (what the code should DO)
- Test expectations (what tests verify)

### Codebases Used
- Flipt (Go): dep-discovery-001, dep-refactor-001, dep-refactor-002, polyglot-ecosystem-001, multi-team-ownership-002, degraded-context-001, repo-scoped-access-002
- Django (Python): dep-impact-001, policy-enforcement-001

### Ground Truth (scripts/ccb_metrics/ground_truth.py)
- Enterprise ground truth in _ENTERPRISE_GROUND_TRUTH dict
- Governance ground truth in _GOVERNANCE_GROUND_TRUTH dict
- Each entry: task_name → (list_of_files, confidence)
- Rebuild cache: python3 scripts/ir_analysis.py --build-ground-truth

### Skip Patterns
- SKIP_PATTERNS used in ir_analysis.py, aggregate_status.py, generate_manifest.py
- Adding __v1_hinted to all three ensures old runs are excluded after task redesign

## Progress

## 2026-02-16 - US-002
- Redesigned 3 Flipt enterprise+governance task instructions to remove over-hinting
- polyglot-ecosystem-001: Removed line numbers, field number hint (10), GetSegmentKeys, file path navigation, entire Hints section
- multi-team-ownership-002: Removed duration.go filename and DurationTracker struct name; consolidated requirements
- degraded-context-001: Removed EvalError, errors.go, struct field names, storage method names, entire Hints section
- Files changed: 3 instruction.md files + prd.json
---

## 2026-02-16 - US-003
- Redesigned 3 remaining governance+enterprise task instructions
- repo-scoped-access-002: Removed metrics.go and EvaluationMetrics
- policy-enforcement-001: Removed SoftDeleteManager, is_deleted, deleted_at, deleted_by
- dep-impact-001: Removed options.py, admin_changelist/, approximately 5 files, entire Hints section
- Files changed: 3 instruction.md files + prd.json
---

## 2026-02-16 - US-004
- Added __v1_hinted to SKIP_PATTERNS in ir_analysis.py, aggregate_status.py, generate_manifest.py
- Added documentation comments near each SKIP_PATTERNS
- Confirmed no enterprise/governance ground truth dicts exist — extraction is automatic
- Rebuilt ground truth cache: 133 tasks (10 enterprise + 6 governance)
- Files changed: 3 analysis scripts + configs/ground_truth_files.json
---

