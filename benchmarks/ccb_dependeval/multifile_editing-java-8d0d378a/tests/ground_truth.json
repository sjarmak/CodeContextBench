{
  "LibJava8.java": "public class LibJava8 {\n   static {\n      Map<String, Object> options = new HashMap<>();\n      options.put(Library.OPTION_ALLOW_OBJECTS, Boolean.TRUE);\n\n      if (OS != Constants.OperatingSystem.MAC) {\n         Native.register(NativeLibrary.getInstance(\"java\", options));\n      } else {\n         Native.register(NativeLibrary.getProcess(options));\n      }\n\n      Java_java_lang_UNIXProcess_init(JNIEnv.CURRENT, BasePosixProcess.class);\n   }\n\n   public static native void Java_java_lang_UNIXProcess_init(JNIEnv jniEnv, Object clazz);\n\n   /**\n    * JNIEXPORT jint JNICALL\n    * Java_java_lang_UNIXProcess_forkAndExec(JNIEnv *env,\n    *                                        jobject process,\n    *                                        jint mode,\n    *                                        jbyteArray helperpath,\n    *                                        jbyteArray prog,\n    *                                        jbyteArray argBlock, jint argc,\n    *                                        jbyteArray envBlock, jint envc,\n    *                                        jbyteArray dir,\n    *                                        jintArray std_fds,\n    *                                        jboolean redirectErrorStream)\n    *\n    * @return the PID of the process\n    */\n   public static native int Java_java_lang_UNIXProcess_forkAndExec(\n           JNIEnv jniEnv,\n           Object process,\n           int mode,\n           Object helperpath,\n           Object prog,\n           Object argBlock, int argc,\n           Object envBlock, int envc,\n           Object dir,\n           Object fds,\n           byte redirectErrorStream\n   ) throws IOException;\n\n   #Modify\n   public static int forkAndExecWithLogging(\n           JNIEnv jniEnv,\n           Object process,\n           int mode,\n           Object helperpath,\n           Object prog,\n           Object argBlock, int argc,\n           Object envBlock, int envc,\n           Object dir,\n           Object fds,\n           byte redirectErrorStream\n   ) throws IOException {\n      // Log the parameters\n      System.out.println(\"Calling forkAndExec with parameters:\");\n      System.out.println(\"mode: \" + mode);\n      System.out.println(\"helperpath: \" + helperpath);\n      System.out.println(\"prog: \" + prog);\n      System.out.println(\"argBlock: \" + argBlock);\n      System.out.println(\"argc: \" + argc);\n      System.out.println(\"envBlock: \" + envBlock);\n      System.out.println(\"envc: \" + envc);\n      System.out.println(\"dir: \" + dir);\n      System.out.println(\"fds: \" + fds);\n      System.out.println(\"redirectErrorStream: \" + redirectErrorStream);\n\n      // Call the native method\n      return Java_java_lang_UNIXProcess_forkAndExec(\n              jniEnv,\n              process,\n              mode,\n              helperpath,\n              prog,\n              argBlock, argc,\n              envBlock, envc,\n              dir,\n              fds,\n              redirectErrorStream\n      );\n   }\n}",
  "Constants.java": "public class Constants {\n   public static final int NUMBER_OF_THREADS;\n   public static final int JVM_MAJOR_VERSION;\n   static final OperatingSystem OS;\n\n   #New\n   public static final String LOGGING_LEVEL = System.getProperty(\"com.zaxxer.nuprocess.logging\", \"INFO\");\n\n   enum OperatingSystem {\n      MAC,\n      LINUX,\n      SOLARIS\n   }\n\n   static int getJavaMajorVersion(String versionString) {\n       String[] parts = versionString.split(\"\\\\.\");\n       // Make sure we handle versions like '11-ea' which ships with centos7\n       int major = Integer.parseInt(parts[0].split(\"\\\\D\")[0]);\n       if (major == 1) {\n         major = Integer.parseInt(parts[1].split(\"\\\\D\")[0]);\n       }\n       return major;\n   }\n\n   static {\n\n      JVM_MAJOR_VERSION = getJavaMajorVersion(System.getProperty(\"java.version\"));\n\n      final String osname = System.getProperty(\"os.name\").toLowerCase();\n      if (osname.contains(\"mac\") || osname.contains(\"freebsd\"))\n          OS = OperatingSystem.MAC;\n      else if (osname.contains(\"linux\"))\n          OS = OperatingSystem.LINUX;\n      else\n          OS = OperatingSystem.SOLARIS;\n\n      final String threads = System.getProperty(\"com.zaxxer.nuprocess.threads\", \"auto\");\n      if (\"auto\".equals(threads)) {\n          NUMBER_OF_THREADS = Math.max(1, Runtime.getRuntime().availableProcessors() / 2);\n      } else if (\"cores\".equals(threads)) {\n          NUMBER_OF_THREADS = Runtime.getRuntime().availableProcessors();\n      } else {\n          NUMBER_OF_THREADS = Math.max(1, Integer.parseInt(threads));\n      }\n\n      #Modify\n      // Initialize logging\n      if (LOGGING_LEVEL.equals(\"DEBUG\")) {\n          System.setProperty(\"com.zaxxer.nuprocess.logging\", \"DEBUG\");\n      }\n   }\n}"
}
