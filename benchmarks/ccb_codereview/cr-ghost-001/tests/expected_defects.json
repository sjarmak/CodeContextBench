[
  {
    "id": "defect-1",
    "file": "ghost/core/core/server/services/comments/comments-service.js",
    "line_start": 263,
    "line_end": 266,
    "type": "bug",
    "severity": "critical",
    "description": "NotFoundError guard removed from getCommentLikes — when comment does not exist, findOne returns null and the code proceeds to query CommentLike.findPage with a null commentId, producing incorrect results instead of a 404 error"
  },
  {
    "id": "defect-2",
    "file": "ghost/core/core/server/services/comments/comments-controller.js",
    "line_start": 366,
    "line_end": 366,
    "type": "bug",
    "severity": "critical",
    "description": "frame.options.id replaced with frame.data.id — controller reads commentId from wrong frame property, causing commentId to be undefined and breaking the likes query"
  },
  {
    "id": "defect-3",
    "file": "ghost/core/core/server/api/endpoints/comment-likes.js",
    "line_start": 9,
    "line_end": 11,
    "type": "violation",
    "severity": "medium",
    "description": "cacheInvalidate header removed from browse action — GET endpoint will invalidate cache on every request, violating the convention that read-only endpoints must not trigger cache invalidation"
  },
  {
    "id": "defect-4",
    "file": "ghost/core/core/server/services/comments/comments-service.js",
    "line_start": 272,
    "line_end": 272,
    "type": "bug",
    "severity": "high",
    "description": "withRelated changed from ['member'] to empty array — CommentLike query no longer eager-loads the member relation, causing the API response to omit member data and breaking the frontend likes display"
  }
]
