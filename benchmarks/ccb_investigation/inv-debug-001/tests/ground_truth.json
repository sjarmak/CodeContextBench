{
  "task_id": "inv-debug-001",
  "description": "Remote-Write Queue Resharding Failure",
  "weights": {
    "required_findings": 0.40,
    "file_references": 0.30,
    "causal_chain": 0.20,
    "negative_checks": 0.10
  },
  "required_findings": [
    {
      "id": "f1",
      "description": "Identifies queue_manager.go",
      "patterns": ["queue_manager\\.go", "queue_manager"],
      "weight": 0.20
    },
    {
      "id": "f2",
      "description": "Mentions calculateDesiredShards function",
      "patterns": ["calculateDesiredShards", "calculate.*[Dd]esired.*[Ss]hards?"],
      "weight": 0.20
    },
    {
      "id": "f3",
      "description": "Mentions dataIn or samplesIn rate tracking",
      "patterns": ["dataIn|samplesIn|samples_in|data_in"],
      "weight": 0.20
    },
    {
      "id": "f4",
      "description": "Mentions EWMA rate",
      "patterns": ["[Ee][Ww][Mm][Aa]|ewmaRate|exponential.*moving.*average"],
      "weight": 0.10
    },
    {
      "id": "f5",
      "description": "Mentions dropped samples not accounted for",
      "patterns": ["drop.*sample|sample.*drop|dataDropped|data_dropped|unaccounted"],
      "weight": 0.30
    }
  ],
  "file_references": [
    {
      "id": "r1",
      "description": "Identifies storage/remote/queue_manager.go",
      "patterns": ["storage/remote/queue_manager\\.go", "storage/remote/queue_manager"],
      "weight": 0.40
    },
    {
      "id": "r2",
      "description": "Identifies storage/remote/write.go",
      "patterns": ["storage/remote/write\\.go", "remote/write\\.go"],
      "weight": 0.40
    },
    {
      "id": "r3",
      "description": "Identifies test file queue_manager_test.go",
      "patterns": ["queue_manager_test\\.go", "queue_manager_test"],
      "weight": 0.20
    }
  ],
  "causal_chain": [
    {
      "id": "c1",
      "description": "dataIn tracking moved/broken causes calculateDesiredShards to get wrong rate leading to shard divergence and queue stalls",
      "patterns": ["dataIn|samplesIn|rate.*track|tick", "calculateDesiredShards|shard.*calculat|wrong.*rate|decay.*zero", "stall|diverge|queue.*stop|no.*progress"],
      "ordered": true,
      "weight": 0.50
    },
    {
      "id": "c2",
      "description": "Dropped samples inflate dataPendingRate causing over-scaling",
      "patterns": ["drop.*sample|dataDropped", "inflate|pending.*rate|dataPending|over.?scal"],
      "ordered": false,
      "weight": 0.50
    }
  ],
  "negative_checks": [
    {
      "id": "n1",
      "description": "Does NOT blame network connectivity, Cortex/Thanos receiver, or scrape config",
      "patterns": ["network.*root.?cause|Cortex.*bug|Thanos.*bug|scrape.*config.*cause"],
      "must_be_absent": true,
      "weight": 1.0
    }
  ]
}
