{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://codecontextbench.dev/schemas/result.schema.json",
  "title": "CodeContextBench Task Result",
  "description": "Schema for Harbor task-level result.json files produced by benchmark runs.",
  "type": "object",
  "required": [
    "task_name",
    "verifier_result",
    "started_at",
    "finished_at",
    "exception_info"
  ],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique trial identifier (UUID)."
    },
    "task_name": {
      "type": "string",
      "description": "Canonical task name, e.g. 'sgt-001' or 'apiserver-doc-001'."
    },
    "trial_name": {
      "type": "string",
      "description": "Trial directory name, typically task_name__hash."
    },
    "trial_uri": {
      "type": "string",
      "description": "File URI pointing to the trial directory on disk."
    },
    "task_id": {
      "type": "object",
      "description": "Task source identifier.",
      "properties": {
        "path": { "type": "string" },
        "git_url": { "type": ["string", "null"] },
        "git_commit_id": { "type": ["string", "null"] }
      }
    },
    "source": {
      "type": ["string", "null"],
      "description": "Benchmark suite source, e.g. 'ccb_k8sdocs'. May be null."
    },
    "task_checksum": {
      "type": "string",
      "description": "SHA-256 checksum of the task definition."
    },
    "config": {
      "type": "object",
      "description": "Full run configuration snapshot.",
      "properties": {
        "task": { "type": "object" },
        "trial_name": { "type": "string" },
        "trials_dir": { "type": "string" },
        "timeout_multiplier": { "type": "number" },
        "agent": { "type": "object" },
        "environment": { "type": "object" },
        "verifier": { "type": "object" },
        "job_id": { "type": "string" }
      }
    },
    "agent_info": {
      "type": ["object", "null"],
      "description": "Information about the agent that ran the task.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Agent name, e.g. 'claude-code'."
        },
        "version": {
          "type": ["string", "null"],
          "description": "Agent version string."
        },
        "model_info": {
          "type": ["object", "null"],
          "description": "Model used by the agent.",
          "properties": {
            "name": {
              "type": "string",
              "description": "Model identifier, e.g. 'anthropic/claude-opus-4-5-20251101'."
            },
            "provider": {
              "type": ["string", "null"],
              "description": "Model provider name."
            }
          }
        }
      }
    },
    "agent_result": {
      "type": ["object", "null"],
      "description": "Agent execution metrics.",
      "properties": {
        "n_input_tokens": {
          "type": ["integer", "null"],
          "description": "Total input tokens consumed."
        },
        "n_output_tokens": {
          "type": ["integer", "null"],
          "description": "Total output tokens produced."
        },
        "n_cache_tokens": {
          "type": ["integer", "null"],
          "description": "Tokens served from cache."
        },
        "cost_usd": {
          "type": ["number", "null"],
          "description": "Estimated cost in USD."
        }
      }
    },
    "verifier_result": {
      "type": "object",
      "description": "Verifier output containing the task reward.",
      "required": ["rewards"],
      "properties": {
        "rewards": {
          "type": "object",
          "description": "Reward scores from the verifier. The 'reward' field is REQUIRED and is the canonical score.",
          "required": ["reward"],
          "properties": {
            "reward": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0,
              "description": "REQUIRED. Canonical reward value (0.0-1.0). This is the primary scoring field â€” not 'score'."
            }
          }
        }
      }
    },
    "exception_info": {
      "type": ["object", "null"],
      "description": "Exception details if the task errored. Null on success.",
      "properties": {
        "type": { "type": "string" },
        "message": { "type": "string" },
        "exception_type": { "type": "string" },
        "exception_message": { "type": "string" }
      }
    },
    "started_at": {
      "type": "string",
      "description": "ISO 8601 timestamp when the trial started."
    },
    "finished_at": {
      "type": "string",
      "description": "ISO 8601 timestamp when the trial finished."
    },
    "environment_setup": {
      "type": ["object", "null"],
      "description": "Timing for environment setup phase.",
      "properties": {
        "started_at": { "type": "string" },
        "finished_at": { "type": "string" }
      }
    },
    "agent_setup": {
      "type": ["object", "null"],
      "description": "Timing for agent setup phase.",
      "properties": {
        "started_at": { "type": "string" },
        "finished_at": { "type": "string" }
      }
    },
    "agent_execution": {
      "type": ["object", "null"],
      "description": "Timing for agent execution phase.",
      "properties": {
        "started_at": { "type": "string" },
        "finished_at": { "type": "string" }
      }
    },
    "verifier": {
      "type": ["object", "null"],
      "description": "Timing for verifier phase.",
      "properties": {
        "started_at": { "type": "string" },
        "finished_at": { "type": "string" }
      }
    },
    "trajectory_path": {
      "type": ["string", "null"],
      "description": "Path to the agent trajectory log file."
    }
  },
  "additionalProperties": true
}
