{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Enterprise Report",
  "description": "Top-level envelope schema wrapping all enterprise sub-reports with metadata. Output of scripts/generate_enterprise_report.py.",
  "type": "object",
  "required": ["generated_at", "ccb_version", "total_tasks", "configs_compared", "sections"],
  "properties": {
    "generated_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of report generation."
    },
    "ccb_version": {
      "type": "string",
      "description": "CodeContextBench version (from git describe)."
    },
    "total_tasks": {
      "type": "integer",
      "description": "Total number of tasks included in the report."
    },
    "configs_compared": {
      "type": "array",
      "items": { "type": "string" },
      "description": "List of agent configurations compared (e.g., ['baseline', 'sourcegraph_full'])."
    },
    "sections": {
      "type": "object",
      "description": "Sub-report sections. Each key maps to the output of a sub-report script. Sections may be null if the sub-script was unavailable.",
      "properties": {
        "workflow_metrics": {
          "description": "Output of workflow_metrics.py (see workflow_metrics_schema.json).",
          "type": ["object", "null"]
        },
        "economic_metrics": {
          "description": "Output of economic_analysis.py (see economic_metrics_schema.json).",
          "type": ["object", "null"]
        },
        "reliability_metrics": {
          "description": "Output of reliability_analysis.py (see reliability_metrics_schema.json).",
          "type": ["object", "null"]
        },
        "failure_analysis": {
          "description": "Output of failure_analysis.py (see failure_analysis_schema.json).",
          "type": ["object", "null"]
        },
        "governance_report": {
          "description": "Output of governance_evaluator.py (see governance_report_schema.json). May be null if not yet implemented.",
          "type": ["object", "null"]
        }
      }
    },
    "executive_summary": {
      "$ref": "#/definitions/executive_summary",
      "description": "Computed executive summary metrics."
    }
  },
  "definitions": {
    "executive_summary": {
      "type": "object",
      "required": ["headline_metric", "reliability_improvement_pct", "time_savings_estimate", "economic_efficiency", "reliability_ci", "top_residual_limitation", "governance_readiness"],
      "properties": {
        "headline_metric": {
          "type": "string",
          "description": "Primary headline (e.g., 'Context infrastructure improves agent reliability by X%')."
        },
        "reliability_improvement_pct": {
          "type": ["number", "null"],
          "description": "Percentage improvement in pass rate (SG_full vs baseline)."
        },
        "time_savings_estimate": {
          "type": ["string", "null"],
          "description": "Human-readable time savings estimate (modeled)."
        },
        "economic_efficiency": {
          "type": ["string", "null"],
          "description": "Human-readable economic efficiency summary."
        },
        "reliability_ci": {
          "type": ["string", "null"],
          "description": "95% CI for SG_full pass rate."
        },
        "top_residual_limitation": {
          "type": ["string", "null"],
          "description": "Most common failure mode that persists in SG_full."
        },
        "governance_readiness": {
          "type": "string",
          "description": "Governance readiness status (placeholder until governance tasks exist)."
        }
      }
    }
  },
  "examples": [
    {
      "generated_at": "2026-02-15T12:00:00+00:00",
      "ccb_version": "v0.1.0-42-gabcdef1",
      "total_tasks": 478,
      "configs_compared": ["baseline", "sourcegraph_base", "sourcegraph_full"],
      "sections": {
        "workflow_metrics": null,
        "economic_metrics": null,
        "reliability_metrics": null,
        "failure_analysis": null,
        "governance_report": null
      },
      "executive_summary": {
        "headline_metric": "Context infrastructure improves agent reliability by 11.1%",
        "reliability_improvement_pct": 11.1,
        "time_savings_estimate": "Modeled estimate: 2.5 engineer-minutes saved per task on average",
        "economic_efficiency": "SG_full costs 25% more per task but passes 10% more tasks",
        "reliability_ci": "SG_full 95% CI: [0.72, 0.87]",
        "top_residual_limitation": "Context Misused (14 tasks in SG_full)",
        "governance_readiness": "Pending â€” governance evaluation not yet implemented"
      }
    }
  ]
}
