{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Economic Metrics",
  "description": "Output schema for scripts/economic_analysis.py â€” per-task cost, per-config aggregates, cost comparison, and ROI summary.",
  "type": "object",
  "required": ["generated_at", "methodology", "per_task", "per_config", "roi_summary"],
  "properties": {
    "generated_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of report generation."
    },
    "methodology": {
      "type": "string",
      "description": "Methodology note on cost computation and disclaimers."
    },
    "per_task": {
      "type": "array",
      "description": "Per-task economic records.",
      "items": {
        "$ref": "#/definitions/task_economic_record"
      }
    },
    "per_config": {
      "type": "object",
      "description": "Aggregated economics per agent configuration.",
      "additionalProperties": {
        "$ref": "#/definitions/config_economics"
      }
    },
    "cost_comparison": {
      "type": "array",
      "description": "Per-task cost effectiveness comparison across configs (included when --compare is set).",
      "items": {
        "$ref": "#/definitions/cost_comparison_record"
      }
    },
    "roi_summary": {
      "$ref": "#/definitions/roi_summary",
      "description": "ROI summary comparing baseline vs SG_full."
    }
  },
  "definitions": {
    "task_economic_record": {
      "type": "object",
      "required": ["task_name", "suite", "config", "cost_usd", "reward", "passed", "cost_per_success", "total_tokens"],
      "properties": {
        "task_name": { "type": "string", "description": "Task identifier (hash-stripped)." },
        "suite": { "type": "string", "description": "Benchmark suite." },
        "config": { "type": "string", "description": "Agent configuration." },
        "cost_usd": { "type": "number", "description": "Hypothetical API cost in USD." },
        "reward": { "type": ["number", "null"], "description": "Task reward (0.0 or 1.0)." },
        "passed": { "type": "boolean", "description": "Whether the task passed (reward > 0)." },
        "cost_per_success": { "type": ["number", "null"], "description": "Cost per successful outcome (null for failing tasks)." },
        "total_tokens": { "type": ["integer", "null"], "description": "Total tokens (input + output)." }
      }
    },
    "config_economics": {
      "type": "object",
      "required": ["n_tasks", "total_cost_usd", "avg_cost_per_task_usd", "avg_cost_per_success_usd", "tasks_passed", "pass_rate", "productivity_per_dollar", "token_efficiency", "total_tokens"],
      "properties": {
        "n_tasks": { "type": "integer", "description": "Number of tasks in this config." },
        "total_cost_usd": { "type": "number", "description": "Total cost across all tasks." },
        "avg_cost_per_task_usd": { "type": "number", "description": "Average cost per task." },
        "avg_cost_per_success_usd": { "type": ["number", "null"], "description": "Average cost per successful task." },
        "tasks_passed": { "type": "integer", "description": "Number of tasks that passed." },
        "pass_rate": { "type": "number", "description": "Fraction of tasks that passed." },
        "productivity_per_dollar": { "type": ["number", "null"], "description": "Tasks passed per dollar spent." },
        "token_efficiency": { "type": ["number", "null"], "description": "Total tokens per successful task." },
        "total_tokens": { "type": ["integer", "null"], "description": "Total tokens across all tasks." }
      }
    },
    "cost_comparison_record": {
      "type": "object",
      "required": ["task_name", "suite", "category", "baseline_cost_usd", "sg_full_cost_usd", "baseline_passed", "sg_full_passed", "marginal_cost_usd"],
      "properties": {
        "task_name": { "type": "string" },
        "suite": { "type": "string" },
        "category": {
          "type": "string",
          "enum": ["cost_effective", "premium", "waste", "no_comparison"],
          "description": "Cost effectiveness category."
        },
        "baseline_cost_usd": { "type": ["number", "null"] },
        "sg_full_cost_usd": { "type": ["number", "null"] },
        "baseline_passed": { "type": ["boolean", "null"] },
        "sg_full_passed": { "type": ["boolean", "null"] },
        "marginal_cost_usd": { "type": ["number", "null"], "description": "SG_full cost minus baseline cost." }
      }
    },
    "roi_summary": {
      "type": "object",
      "required": ["baseline_avg_cost_usd", "sg_full_avg_cost_usd", "cost_delta_pct", "baseline_pass_rate", "sg_full_pass_rate", "pass_rate_delta", "additional_passes_from_context", "total_marginal_cost_usd", "break_even_hours", "implied_hours_saved_per_dollar", "comparison_category_counts", "note"],
      "properties": {
        "baseline_avg_cost_usd": { "type": "number" },
        "sg_full_avg_cost_usd": { "type": "number" },
        "cost_delta_pct": { "type": ["number", "null"], "description": "Percentage change in cost (SG_full vs baseline)." },
        "baseline_pass_rate": { "type": "number" },
        "sg_full_pass_rate": { "type": "number" },
        "pass_rate_delta": { "type": ["number", "null"], "description": "SG_full pass rate minus baseline pass rate." },
        "additional_passes_from_context": { "type": "integer", "description": "Tasks that only passed with context infrastructure." },
        "total_marginal_cost_usd": { "type": "number", "description": "Sum of marginal costs across comparable tasks." },
        "break_even_hours": { "type": ["number", "null"], "description": "Engineer-hours at $75/hr equivalent to total marginal cost." },
        "implied_hours_saved_per_dollar": { "type": ["number", "null"], "description": "Modeled engineer-hours saved per dollar of MCP cost." },
        "comparison_category_counts": {
          "type": "object",
          "description": "Counts by cost comparison category.",
          "additionalProperties": { "type": "integer" }
        },
        "note": { "type": "string", "description": "Methodology disclaimer." }
      }
    }
  },
  "examples": [
    {
      "generated_at": "2026-02-15T12:00:00+00:00",
      "methodology": "Hypothetical API costs from per-message token counts. ROI metrics are MODELED ESTIMATES.",
      "per_task": [
        {
          "task_name": "example_task",
          "suite": "ccb_pytorch",
          "config": "baseline",
          "cost_usd": 2.45,
          "reward": 1.0,
          "passed": true,
          "cost_per_success": 2.45,
          "total_tokens": 150000
        }
      ],
      "per_config": {
        "baseline": {
          "n_tasks": 150,
          "total_cost_usd": 340.5,
          "avg_cost_per_task_usd": 2.27,
          "avg_cost_per_success_usd": 3.29,
          "tasks_passed": 103,
          "pass_rate": 0.6867,
          "productivity_per_dollar": 0.3025,
          "token_efficiency": 180000,
          "total_tokens": 18540000
        }
      },
      "roi_summary": {
        "baseline_avg_cost_usd": 2.27,
        "sg_full_avg_cost_usd": 2.85,
        "cost_delta_pct": 25.55,
        "baseline_pass_rate": 0.69,
        "sg_full_pass_rate": 0.80,
        "pass_rate_delta": 0.11,
        "additional_passes_from_context": 12,
        "total_marginal_cost_usd": 85.4,
        "break_even_hours": 1.1387,
        "implied_hours_saved_per_dollar": 0.0702,
        "comparison_category_counts": {
          "cost_effective": 36,
          "premium": 12,
          "waste": 80,
          "no_comparison": 18
        },
        "note": "All cost figures are hypothetical API costs. MODELED ESTIMATES."
      }
    }
  ]
}
